<!DOCTYPE html>
<html lang="en" data-root="/lamg.github.io/">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="author">
    <!-- Opengraph properties (https://ogp.me/) -->
    <meta property="og:site_name" content="lamg.github.io">
    <meta property="og:title" content="Queue
" />
    <meta property="og:url" content="/lamg.github.io/script.html">
    <meta property="og:type" content="website" />
    <!-- Twitter cards (https://developer.twitter.com/en/docs/twitter-for-websites/cards/overview/summary-card-with-large-image) -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="/lamg.github.io/">
    <meta name="twitter:title" content="Queue
">
    
    <title>Queue
 | lamg.github.io</title>
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <link href="/lamg.github.io/img/favicon.ico" rel="icon" sizes="32x32" type="image/png"/>
    <script type="application/javascript" src="/lamg.github.io/content/fsdocs-theme-set-dark.js"></script>
    <link href="/lamg.github.io/content/fsdocs-default.css" rel="stylesheet" type="text/css"/>
    <link href="/lamg.github.io/content/fsdocs-theme.css" rel="stylesheet" type="text/css"/>
    
    
</head>
<body class="content">
<header>
    <div class="start">
        <div id="menu-toggle">
            <iconify-icon class="icon closed" height="22" icon="eva:menu-fill" width="22"></iconify-icon>
            <iconify-icon class="icon open" height="22" icon="mi:close" width="22"></iconify-icon>
            <input type="checkbox" name="mobile-menu" />
            <ul class="menu">
                <li class="nav-header">Links</li>
                <li class="nav-item"><a class="nav-link" href="{{fsdocs-license-link}}">License</a>
                </li>
                <li class="nav-item"><a class="nav-link"
                                        href="{{fsdocs-release-notes-link}}">Release
                    Notes</a></li>
                <li class="nav-item"><a class="nav-link" href="{{fsdocs-repository-link}}">Source
                    Repository</a></li>
                <li class="nav-header">
  Documentation
</li>             
<li class="nav-item ">
  <a class="nav-link" href="/lamg.github.io/fixed_points.html">
    Fixed points

  </a>
</li>             
<li class="nav-item active">
  <a class="nav-link" href="/lamg.github.io/queue.html">
    Queue

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="/lamg.github.io/README.html">
    Structured programming in F#

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="/lamg.github.io/pattern_matching_nesting_reduction.html">
    Pattern matching nesting reduction

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="/lamg.github.io/exception_vs_result.html">
    Exception vs Result

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="/lamg.github.io/bfs.html">
    Revisiting BFS

  </a>
</li>
                
            </ul>
        </div>
        <a href="/lamg.github.io/">
            <img alt="Header menu logo" src="/lamg.github.io/img/logo.png">
            <strong>lamg.github.io</strong>
        </a>
    </div>
    <div class="end">
        <a href="{{fsdocs-repository-link}}" target="_blank">
            <iconify-icon icon="uil:github" width="26" height="26"></iconify-icon>
        </a>
        <iconify-icon id="search-btn" icon="carbon:search" class="search" width="24" height="24"></iconify-icon>
        <fsdocs-theme-toggle></fsdocs-theme-toggle>
    </div>
</header>
<aside id="fsdocs-main-menu">
    <ul class="menu">
        <li class="nav-header">Links</li>
        <li class="nav-item"><a class="nav-link" href="{{fsdocs-license-link}}">License</a>
        </li>
        <li class="nav-item"><a class="nav-link"
                                href="{{fsdocs-release-notes-link}}">Release
            Notes</a></li>
        <li class="nav-item"><a class="nav-link" href="{{fsdocs-repository-link}}">Source
            Repository</a></li>
        <li class="nav-header">
  Documentation
</li>             
<li class="nav-item ">
  <a class="nav-link" href="/lamg.github.io/fixed_points.html">
    Fixed points

  </a>
</li>             
<li class="nav-item active">
  <a class="nav-link" href="/lamg.github.io/queue.html">
    Queue

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="/lamg.github.io/README.html">
    Structured programming in F#

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="/lamg.github.io/pattern_matching_nesting_reduction.html">
    Pattern matching nesting reduction

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="/lamg.github.io/exception_vs_result.html">
    Exception vs Result

  </a>
</li>             
<li class="nav-item ">
  <a class="nav-link" href="/lamg.github.io/bfs.html">
    Revisiting BFS

  </a>
</li>
        
    </ul>
</aside>
<main>
    <div id="content">
        <h1><a name="Queue" class="anchor" href="#Queue">Queue</a></h1>
<p>A queue is data structure that stores a sequence of elements, while supporting two basic operations: <code>enqueue</code> and <code>dequeue</code></p>
<p>Let's visualize how it works:</p>
<pre class="fssnip highlighted"><code lang="fsharp"> <span class="pn">[</span><span class="n">0</span><span class="pn">;</span> <span class="n">1</span><span class="pn">;</span> <span class="n">2</span><span class="pn">]</span>
<span class="o">=</span> <span class="pn">{</span> <span class="id">enqueue</span> <span class="n">42</span> <span class="pn">}</span>
 <span class="pn">[</span><span class="n">0</span><span class="pn">;</span> <span class="n">1</span><span class="pn">;</span> <span class="n">2</span><span class="pn">;</span> <span class="n">42</span><span class="pn">]</span>
</code></pre>
<pre class="fssnip highlighted"><code lang="fsharp"> <span class="pn">[</span><span class="n">0</span><span class="pn">;</span> <span class="n">1</span><span class="pn">;</span> <span class="n">2</span><span class="pn">]</span>
<span class="o">=</span> <span class="pn">{</span> <span class="id">dequeue</span> <span class="pn">}</span>
 <span class="n">0</span><span class="pn">,</span> <span class="pn">[</span><span class="n">1</span><span class="pn">;</span> <span class="n">2</span><span class="pn">]</span>
</code></pre>
<h5><a name="First-restriction-rely-on-inmutable-data-structures" class="anchor" href="#First-restriction-rely-on-inmutable-data-structures">First restriction: rely on inmutable data structures</a></h5>
<ul>
<li>Using a list we can rely on the operator <code>::</code> for dequeueing, since pattern matching <code>x::xs</code> O(1)</li>
<li>However this means for enqueuing we need to do <code>xs @ [x]</code> which is O(n), where <code>n = xs.Length</code></li>
</ul>
<h5><a name="Solution" class="anchor" href="#Solution">Solution:</a></h5>
<ul>
<li>rely on <code>::</code> for both <code>enqueue</code> and <code>dequeue</code>, since the operation <code>x::xs</code> is O(1)</li>
<li>We can use two lists one enqueueing and one for dequeueing, <code>front</code> and <code>rear</code> respectively</li>
<li>For dequeueing elements we do the pattern match <code>x::xs</code> on <code>front</code> getting in <code>x</code> the expected element, while in <code>xs</code> the new value for <code>front</code>.</li>
<li>For enqueueing we repleace <code>rear</code> by <code>x::rear</code>, however this list ends up reversed according the expected order when dequeueing, since <code>x</code> is its first element and should be the last dequeued.</li>
<li>At some point the <code>dequeue</code> operation will leave empty the <code>front</code> list. When that happens we can take <code>rear</code>, reverse it and use it as the new <code>front</code> while the new <code>rear</code> is an empty list.</li>
</ul>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="rt">Queue</span><span class="pn">&lt;</span><span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="id">a</span><span class="pn">&gt;</span> <span class="o">=</span> <span class="pn">{</span> <span class="prop">front</span><span class="pn">:</span> <span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs2', 3)" onmouseover="showTip(event, 'fs2', 3)" class="id">a</span> <span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="rt">list</span><span class="pn">;</span> <span class="prop">rear</span><span class="pn">:</span> <span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs2', 5)" onmouseover="showTip(event, 'fs2', 5)" class="id">a</span> <span onmouseout="hideTip(event, 'fs3', 6)" onmouseover="showTip(event, 'fs3', 6)" class="rt">list</span> <span class="pn">}</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 7)" onmouseover="showTip(event, 'fs4', 7)" class="fn">enqueue</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 8)" onmouseover="showTip(event, 'fs5', 8)" class="fn">q</span><span class="pn">:</span> <span onmouseout="hideTip(event, 'fs1', 9)" onmouseover="showTip(event, 'fs1', 9)" class="rt">Queue</span><span class="pn">&lt;</span><span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs2', 10)" onmouseover="showTip(event, 'fs2', 10)" class="id">a</span><span class="pn">&gt;</span><span class="pn">)</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs6', 11)" onmouseover="showTip(event, 'fs6', 11)" class="fn">x</span><span class="pn">:</span> <span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs2', 12)" onmouseover="showTip(event, 'fs2', 12)" class="id">a</span><span class="pn">)</span> <span class="o">=</span> <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs5', 13)" onmouseover="showTip(event, 'fs5', 13)" class="fn">q</span> <span class="k">with</span> <span class="prop">rear</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 14)" onmouseover="showTip(event, 'fs6', 14)" class="fn">x</span> <span class="uc">::</span> <span onmouseout="hideTip(event, 'fs5', 15)" onmouseover="showTip(event, 'fs5', 15)" class="fn">q</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs7', 16)" onmouseover="showTip(event, 'fs7', 16)" class="id">rear</span> <span class="pn">}</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 17)" onmouseover="showTip(event, 'fs8', 17)" class="fn">dequeue</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 18)" onmouseover="showTip(event, 'fs5', 18)" class="fn">q</span><span class="pn">:</span> <span onmouseout="hideTip(event, 'fs1', 19)" onmouseover="showTip(event, 'fs1', 19)" class="rt">Queue</span><span class="pn">&lt;</span><span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs2', 20)" onmouseover="showTip(event, 'fs2', 20)" class="id">a</span><span class="pn">&gt;</span><span class="pn">)</span> <span class="o">=</span>
  <span class="k">match</span> <span onmouseout="hideTip(event, 'fs5', 21)" onmouseover="showTip(event, 'fs5', 21)" class="fn">q</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs9', 22)" onmouseover="showTip(event, 'fs9', 22)" class="id">front</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs10', 23)" onmouseover="showTip(event, 'fs10', 23)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs11', 24)" onmouseover="showTip(event, 'fs11', 24)" class="id">rev</span> <span onmouseout="hideTip(event, 'fs5', 25)" onmouseover="showTip(event, 'fs5', 25)" class="fn">q</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs7', 26)" onmouseover="showTip(event, 'fs7', 26)" class="id">rear</span> <span class="k">with</span>
  <span class="pn">|</span> <span class="pn">[</span><span class="pn">]</span><span class="pn">,</span> <span class="pn">[</span><span class="pn">]</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs12', 27)" onmouseover="showTip(event, 'fs12', 27)" class="uc">None</span>
  <span class="pn">|</span> <span class="pn">[</span><span class="pn">]</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs6', 28)" onmouseover="showTip(event, 'fs6', 28)" class="fn">x</span> <span class="uc">::</span> <span onmouseout="hideTip(event, 'fs13', 29)" onmouseover="showTip(event, 'fs13', 29)" class="fn">xs</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs14', 30)" onmouseover="showTip(event, 'fs14', 30)" class="uc">Some</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs6', 31)" onmouseover="showTip(event, 'fs6', 31)" class="fn">x</span><span class="pn">,</span> <span class="pn">{</span> <span class="prop">front</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 32)" onmouseover="showTip(event, 'fs13', 32)" class="fn">xs</span><span class="pn">;</span> <span class="prop">rear</span> <span class="o">=</span> <span class="pn">[</span><span class="pn">]</span> <span class="pn">}</span><span class="pn">)</span>
  <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs6', 33)" onmouseover="showTip(event, 'fs6', 33)" class="fn">x</span> <span class="uc">::</span> <span onmouseout="hideTip(event, 'fs13', 34)" onmouseover="showTip(event, 'fs13', 34)" class="fn">xs</span><span class="pn">,</span> <span class="id">_</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs14', 35)" onmouseover="showTip(event, 'fs14', 35)" class="uc">Some</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs6', 36)" onmouseover="showTip(event, 'fs6', 36)" class="fn">x</span><span class="pn">,</span> <span class="pn">{</span> <span onmouseout="hideTip(event, 'fs5', 37)" onmouseover="showTip(event, 'fs5', 37)" class="fn">q</span> <span class="k">with</span> <span class="prop">front</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 38)" onmouseover="showTip(event, 'fs13', 38)" class="fn">xs</span> <span class="pn">}</span><span class="pn">)</span>

<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs15', 39)" onmouseover="showTip(event, 'fs15', 39)" class="fn">queueToSeq</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs5', 40)" onmouseover="showTip(event, 'fs5', 40)" class="fn">q</span><span class="pn">:</span> <span onmouseout="hideTip(event, 'fs1', 41)" onmouseover="showTip(event, 'fs1', 41)" class="rt">Queue</span><span class="pn">&lt;</span><span class="ta">&#39;</span><span onmouseout="hideTip(event, 'fs2', 42)" onmouseover="showTip(event, 'fs2', 42)" class="id">a</span><span class="pn">&gt;</span><span class="pn">)</span> <span class="o">=</span>
  <span onmouseout="hideTip(event, 'fs16', 43)" onmouseover="showTip(event, 'fs16', 43)" class="fn">seq</span> <span class="pn">{</span>
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs8', 44)" onmouseover="showTip(event, 'fs8', 44)" class="fn">dequeue</span> <span onmouseout="hideTip(event, 'fs5', 45)" onmouseover="showTip(event, 'fs5', 45)" class="fn">q</span> <span class="k">with</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs12', 46)" onmouseover="showTip(event, 'fs12', 46)" class="uc">None</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs14', 47)" onmouseover="showTip(event, 'fs14', 47)" class="uc">Some</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs6', 48)" onmouseover="showTip(event, 'fs6', 48)" class="fn">x</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs17', 49)" onmouseover="showTip(event, 'fs17', 49)" class="fn">nq</span><span class="pn">)</span> <span class="k">-&gt;</span>
      <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs6', 50)" onmouseover="showTip(event, 'fs6', 50)" class="fn">x</span>
      <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs15', 51)" onmouseover="showTip(event, 'fs15', 51)" class="fn">queueToSeq</span> <span onmouseout="hideTip(event, 'fs17', 52)" onmouseover="showTip(event, 'fs17', 52)" class="fn">nq</span>
  <span class="pn">}</span>
</code></pre>
<p>Let's make a simple test for our algorithm:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 53)" onmouseover="showTip(event, 'fs18', 53)" class="id">xs</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 54)" onmouseover="showTip(event, 'fs19', 54)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 55)" onmouseover="showTip(event, 'fs20', 55)" class="id">init</span> <span class="n">10</span> <span onmouseout="hideTip(event, 'fs21', 56)" onmouseover="showTip(event, 'fs21', 56)" class="fn">id</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 57)" onmouseover="showTip(event, 'fs19', 57)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs22', 58)" onmouseover="showTip(event, 'fs22', 58)" class="id">toList</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 59)" onmouseover="showTip(event, 'fs23', 59)" class="id">q</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs18', 60)" onmouseover="showTip(event, 'fs18', 60)" class="id">xs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 61)" onmouseover="showTip(event, 'fs19', 61)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs24', 62)" onmouseover="showTip(event, 'fs24', 62)" class="id">fold</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs23', 63)" onmouseover="showTip(event, 'fs23', 63)" class="fn">q</span> <span onmouseout="hideTip(event, 'fs25', 64)" onmouseover="showTip(event, 'fs25', 64)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs4', 65)" onmouseover="showTip(event, 'fs4', 65)" class="fn">enqueue</span> <span onmouseout="hideTip(event, 'fs23', 66)" onmouseover="showTip(event, 'fs23', 66)" class="fn">q</span> <span onmouseout="hideTip(event, 'fs25', 67)" onmouseover="showTip(event, 'fs25', 67)" class="fn">x</span><span class="pn">)</span> <span class="pn">{</span><span class="prop">front</span> <span class="o">=</span> <span class="pn">[</span><span class="pn">]</span><span class="pn">;</span> <span class="prop">rear</span> <span class="o">=</span> <span class="pn">[</span><span class="pn">]</span><span class="pn">}</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 68)" onmouseover="showTip(event, 'fs26', 68)" class="id">ys</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 69)" onmouseover="showTip(event, 'fs15', 69)" class="fn">queueToSeq</span> <span onmouseout="hideTip(event, 'fs23', 70)" onmouseover="showTip(event, 'fs23', 70)" class="id">q</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 71)" onmouseover="showTip(event, 'fs19', 71)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs22', 72)" onmouseover="showTip(event, 'fs22', 72)" class="id">toList</span>
<span onmouseout="hideTip(event, 'fs10', 73)" onmouseover="showTip(event, 'fs10', 73)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs27', 74)" onmouseover="showTip(event, 'fs27', 74)" class="id">zip</span> <span onmouseout="hideTip(event, 'fs18', 75)" onmouseover="showTip(event, 'fs18', 75)" class="id">xs</span> <span onmouseout="hideTip(event, 'fs26', 76)" onmouseover="showTip(event, 'fs26', 76)" class="id">ys</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 77)" onmouseover="showTip(event, 'fs10', 77)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs28', 78)" onmouseover="showTip(event, 'fs28', 78)" class="id">forall</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs25', 79)" onmouseover="showTip(event, 'fs25', 79)" class="fn">x</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs29', 80)" onmouseover="showTip(event, 'fs29', 80)" class="fn">y</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs25', 81)" onmouseover="showTip(event, 'fs25', 81)" class="fn">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs29', 82)" onmouseover="showTip(event, 'fs29', 82)" class="fn">y</span><span class="pn">)</span>
</code></pre>
<p><div class="dni-plaintext"><pre>True</pre></div><style>
.dni-code-hint {
    font-style: italic;
    overflow: hidden;
    white-space: nowrap;
}
.dni-treeview {
    white-space: nowrap;
}
.dni-treeview td {
    vertical-align: top;
    text-align: start;
}
details.dni-treeview {
    padding-left: 1em;
}
table td {
    text-align: start;
}
table tr { 
    vertical-align: top; 
    margin: 0em 0px;
}
table tr td pre 
{ 
    vertical-align: top !important; 
    margin: 0em 0px !important;
} 
table th {
    text-align: start;
}
</style>
</p>
<p>Notice that in the current implementation of Microsoft's F# compiler, the following pattern match</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">match</span> <span class="id">q</span><span class="pn">.</span><span class="id">front</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs10', 83)" onmouseover="showTip(event, 'fs10', 83)" class="id">List</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs11', 84)" onmouseover="showTip(event, 'fs11', 84)" class="id">rev</span> <span class="id">q</span><span class="pn">.</span><span class="id">rear</span> <span class="k">with</span>
<span class="pn">|</span> <span class="pn">[</span><span class="pn">]</span><span class="pn">,</span> <span class="pn">[</span><span class="pn">]</span> <span class="k">-&gt;</span> <span class="o">..</span><span class="pn">.</span>
<span class="pn">|</span> <span class="pn">[</span><span class="pn">]</span><span class="pn">,</span> <span class="id">x</span> <span class="o">::</span> <span class="id">xs</span> <span class="k">-&gt;</span> <span class="o">..</span><span class="pn">.</span>
<span class="pn">|</span> <span class="id">x</span> <span class="o">::</span> <span class="id">xs</span><span class="pn">,</span> <span class="id">_</span> <span class="k">-&gt;</span> <span class="o">..</span><span class="pn">.</span>
</code></pre>
<p>evaluates <code>List.rev q.rear</code> always before matching any branch. This means that the code could easily be made more efficient. However, I think it makes no sense to evaluate such an expression until after <code>q.front</code> has been matched, since in some situations this would be sufficient to decide which branch to take. For this reason, I prefer to present the algorithm as it is, and leave it to the reader to optimise it if they think it is necessary.</p>

        <div class="fsdocs-tip" id="fs1">type Queue&lt;&#39;a&gt; =
  {
    front: &#39;a list
    rear: &#39;a list
  }</div>
<div class="fsdocs-tip" id="fs2">&#39;a</div>
<div class="fsdocs-tip" id="fs3">type &#39;T list = List&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs4">val enqueue: q: Queue&lt;&#39;a&gt; -&gt; x: &#39;a -&gt; Queue&lt;&#39;a&gt;</div>
<div class="fsdocs-tip" id="fs5">val q: Queue&lt;&#39;a&gt;</div>
<div class="fsdocs-tip" id="fs6">val x: &#39;a</div>
<div class="fsdocs-tip" id="fs7">Queue.rear: &#39;a list</div>
<div class="fsdocs-tip" id="fs8">val dequeue: q: Queue&lt;&#39;a&gt; -&gt; (&#39;a * Queue&lt;&#39;a&gt;) option</div>
<div class="fsdocs-tip" id="fs9">Queue.front: &#39;a list</div>
<div class="fsdocs-tip" id="fs10">Multiple items<br />module List

from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =
  | op_Nil
  | op_ColonColon of Head: &#39;T * Tail: &#39;T list
  interface IReadOnlyList&lt;&#39;T&gt;
  interface IReadOnlyCollection&lt;&#39;T&gt;
  interface IEnumerable
  interface IEnumerable&lt;&#39;T&gt;
  member GetReverseIndex: rank: int * offset: int -&gt; int
  member GetSlice: startIndex: int option * endIndex: int option -&gt; &#39;T list
  static member Cons: head: &#39;T * tail: &#39;T list -&gt; &#39;T list
  member Head: &#39;T
  member IsEmpty: bool
  member Item: index: int -&gt; &#39;T with get
  ...</div>
<div class="fsdocs-tip" id="fs11">val rev: list: &#39;T list -&gt; &#39;T list</div>
<div class="fsdocs-tip" id="fs12">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs13">val xs: &#39;a list</div>
<div class="fsdocs-tip" id="fs14">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs15">val queueToSeq: q: Queue&lt;&#39;a&gt; -&gt; &#39;a seq</div>
<div class="fsdocs-tip" id="fs16">Multiple items<br />val seq: sequence: &#39;T seq -&gt; &#39;T seq<br /><br />--------------------<br />type &#39;T seq = System.Collections.Generic.IEnumerable&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs17">val nq: Queue&lt;&#39;a&gt;</div>
<div class="fsdocs-tip" id="fs18">val xs: int list</div>
<div class="fsdocs-tip" id="fs19">module Seq

from Microsoft.FSharp.Collections</div>
<div class="fsdocs-tip" id="fs20">val init: count: int -&gt; initializer: (int -&gt; &#39;T) -&gt; &#39;T seq</div>
<div class="fsdocs-tip" id="fs21">val id: x: &#39;T -&gt; &#39;T</div>
<div class="fsdocs-tip" id="fs22">val toList: source: &#39;T seq -&gt; &#39;T list</div>
<div class="fsdocs-tip" id="fs23">val q: Queue&lt;int&gt;</div>
<div class="fsdocs-tip" id="fs24">val fold&lt;&#39;T,&#39;State&gt; : folder: (&#39;State -&gt; &#39;T -&gt; &#39;State) -&gt; state: &#39;State -&gt; source: &#39;T seq -&gt; &#39;State</div>
<div class="fsdocs-tip" id="fs25">val x: int</div>
<div class="fsdocs-tip" id="fs26">val ys: int list</div>
<div class="fsdocs-tip" id="fs27">val zip: list1: &#39;T1 list -&gt; list2: &#39;T2 list -&gt; (&#39;T1 * &#39;T2) list</div>
<div class="fsdocs-tip" id="fs28">val forall: predicate: (&#39;T -&gt; bool) -&gt; list: &#39;T list -&gt; bool</div>
<div class="fsdocs-tip" id="fs29">val y: int</div>

    </div>
</main>
<aside id="fsdocs-page-menu">
    <p id="on-this-page">On this page</p>
    <ul>
  <li class="level-1">
    <a href="#Queue">
      Queue
    </a>
  </li>
  <li class="level-5">
    <a href="#First-restriction-rely-on-inmutable-data-structures">
      First restriction: rely on inmutable data structures
    </a>
  </li>
  <li class="level-5">
    <a href="#Solution">
      Solution:
    </a>
  </li>
</ul>
</aside>
<dialog>
    <input type="search" placeholder="Search docs" />
    <div class="results">
        <ul></ul>
        <p class="empty">Type something to start searching.</p>
    </div>
</dialog>
<script type="module" src="/lamg.github.io/content/fsdocs-tips.js"></script>
<script type="module" src="/lamg.github.io/content/fsdocs-theme-toggle.js"></script>
<script type="module" src="/lamg.github.io/content/fsdocs-theme.js"></script>
<script type="module" src="/lamg.github.io/content/fsdocs-search.js"></script>

</body>
</html>